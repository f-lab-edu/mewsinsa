<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mewsinsa.order.repository.OrderedProductRepository">

  <insert id="addOrderedProduct" parameterType="com.mewsinsa.order.domain.OrderedProduct"
    useGeneratedKeys="true" keyProperty="orderedProduct.orderedProductId" keyColumn="ordered_product_id">
    INSERT INTO ordered_product (order_id, product_option_id, coupon_id, quantity, piece_price)
    VALUES (#{orderId}, #{orderedProduct.productOptionId},#{orderedProduct.appliedCouponId},
    #{orderedProduct.productOptionCount}, #{orderedProduct.piecePrice})
  </insert>
  <delete id="deleteOrderedProduct">
    DELETE FROM ordered_product WHERE ordered_product_id = #{orderedProductId}
  </delete>
  <select id="findOrderedProductByOrderedProductId"
          resultType="com.mewsinsa.order.domain.OrderedProduct">
    SELECT
    product_option_id AS productOptionId,
    quantity AS productOptionCount,
    coupon_id AS appliedCouponId,
    ordered_product_id AS orderedProductId,
    order_id AS orderId,
    piece_price AS piecePrice
    FROM ordered_product
    WHERE ordered_product_id = #{orderedProductId}
  </select>
</mapper>